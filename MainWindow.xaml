<Window x:Class="MupenToolkit.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MupenToolkit"
        xmlns:ui="clr-namespace:MupenToolkit.Core.UI"
        xmlns:resx="clr-namespace:MupenToolkit.Properties"
        xmlns:gif="http://wpfanimatedgif.codeplex.com"
        mc:Ignorable="d"
        AllowDrop="True"
        DragDrop.Drop="Window_Drop"
        Title="{x:Static resx:Resources.AppName}" Height="500" Width="900">
    <Window.DataContext>
        <ui:StateContainer/>
    </Window.DataContext>

    <Grid x:Name="Grid_ParentAll">

        <Grid x:Name="Grid_Main" IsHitTestVisible="{Binding FileLoaded}" Opacity="0">
            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding FileLoaded}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <Grid ShowGridLines="False">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2.5*" />
                    <ColumnDefinition Width="2.5*" />
                </Grid.ColumnDefinitions>

                <GroupBox Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Content="Header" Margin="5"/>
                <GroupBox Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Content="Input" Margin="5"/>

                <Grid ShowGridLines="False" Margin="20" Grid.Column="1">

                    <!-- Input -->
                    <Grid.RowDefinitions>
                        <RowDefinition Height="2.5*" />
                        <RowDefinition Height="2.5*" />
                    </Grid.RowDefinitions>

                    <TabControl HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.RowSpan="2">
                        <TabItem Header="{x:Static resx:Resources.TASStudio}">
                            <ui:ExtendedDataGrid x:Name="DataGrid_TASStudio" 
                          EnableRowVirtualization="True" 
                          EnableColumnVirtualization="True"
                          AlternatingRowBackground="LightGray"
                          GridLinesVisibility="Horizontal"
                          HorizontalGridLinesBrush="Gray"
                          VerticalGridLinesBrush="Gray"
                          SelectionMode="Extended"
                          SelectionUnit="FullRow"
                          AlternationCount="2" 
                          AutoGenerateColumns="False" 
                          ColumnWidth="40"
                          Grid.RowSpan="2" 
                          CanUserResizeRows="True"
                          CanUserDeleteRows="False"
                          CanUserResizeColumns="False"
                          VirtualizingPanel.IsVirtualizingWhenGrouping="True" 
                          RowHeight="23"
                          ScrollViewer.HorizontalScrollBarVisibility="Visible"
                          ScrollViewer.VerticalScrollBarVisibility="Visible"
                          CanUserSortColumns="False"
                              CanUserReorderColumns="False" 
                          ui:DataGridBehavior.DisplayRowNumber="True">
                               
                        <DataGrid.ContextMenu>
                            <ContextMenu >
                                <MenuItem Header="Copy" Command="ApplicationCommands.Copy" />
                                <MenuItem Header="Paste" Command="ApplicationCommands.Paste" />

                                <DockPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
                                    <Label    Content="{x:Static resx:Resources.Controller}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                                    <TextBox  Text="{Binding CurrentController, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                                </DockPanel>
                                <MenuItem Header="Input Statistics" Command="{Binding InputStatistics}"/>
                            </ContextMenu>
                        </DataGrid.ContextMenu>
                        <DataGrid.ItemsSource>
                            <MultiBinding Converter="{StaticResource minConverter}">
                                <Binding Path="Input.Samples"/>
                                <Binding Path="CurrentController" UpdateSourceTrigger="PropertyChanged"/>
                            </MultiBinding>
                        </DataGrid.ItemsSource>
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="D>"        Width="*" Binding="{Binding DPadRight,   Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="D&lt;" Width="*"     Binding="{Binding DPadLeft,    Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="Dv"    Width="*"     Binding="{Binding DPadDown,    Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="D^"    Width="*"     Binding="{Binding DPadUp,      Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="S"     Width="*"     Binding="{Binding Start,       Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="Z"         Width="*" Binding="{Binding Z,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="B"         Width="*" Binding="{Binding B,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="A"         Width="*" Binding="{Binding A,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="C>"    Width="*"     Binding="{Binding CPadRight,   Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="C&lt;" Width="*"     Binding="{Binding CPadLeft,    Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="Cv"    Width="*"     Binding="{Binding CPadDown,    Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="D^"    Width="*"     Binding="{Binding CPadUp,      Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="R"         Width="*" Binding="{Binding R,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridCheckBoxColumn Header="L"         Width="*" Binding="{Binding L,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="X"             Width="*" Binding="{Binding X,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="Y"             Width="*" Binding="{Binding Y,           Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataGrid.Columns>
                    </ui:ExtendedDataGrid>
                            
                        </TabItem>

                        <TabItem Header="{x:Static resx:Resources.Analog}" IsEnabled="True">
                            <Grid>
                                <Grid ShowGridLines="False">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="2.5*"/>
                                        <RowDefinition Height="2.5*"/>
                                    </Grid.RowDefinitions>
                                    <Grid ShowGridLines="False" Grid.Column="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2.5*"/>
                                            <ColumnDefinition Width="2.5*"/>
                                        </Grid.ColumnDefinitions>

                                        <Canvas x:Name="Canvas_Joystick" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                                Width="{Binding cW, Mode=OneWayToSource}"  
                                                Height="{Binding cH, Mode=OneWayToSource}"
                                                 >
                                            <Ellipse
                                            Width="{Binding ElementName=Canvas_Joystick, Path=Width}"
                                            Height="{Binding ElementName=Canvas_Joystick, Path=Height}"
                                            Fill="White"
                                            Stroke="Black"
                                            StrokeThickness="1"
                                           />
                                            <Line Stroke="Red" StrokeThickness="5"
                                                  X1="{Binding ElementName=Canvas_Joystick, Path=Width, Converter={StaticResource div}, ConverterParameter=2}"
                                                  Y1="{Binding ElementName=Canvas_Joystick, Path=Height, Converter={StaticResource div}, ConverterParameter=2}"
                                                  X2="{Binding Path=SelectedSample.X}"
                                                  Y2="{Binding Path=SelectedSample.Y}"
                                                  />

                                        </Canvas>

                                        <Grid ShowGridLines="False" Grid.Column="1">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*" />
                                                <ColumnDefinition Width="3*" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="*" />
                                            </Grid.RowDefinitions>
                                            <Label     Grid.Column="0" Grid.Row="0" Content="{x:Static resx:Resources.AxisX}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <TextBox   Grid.Column="1" Grid.Row="0" Text="{Binding SelectedSample.X, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label     Grid.Column="0" Grid.Row="1" Content="{x:Static resx:Resources.AxisY}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <TextBox   Grid.Column="1" Grid.Row="1" Text="{Binding SelectedSample.Y, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <Label     Grid.Column="0" Grid.Row="2" Content="{x:Static resx:Resources.Angle}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                            <TextBox   Grid.Column="1" Grid.Row="2" Text="{Binding Header.Author, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                        </Grid>


                                    </Grid>

                                    <Grid ShowGridLines="False" Grid.Row="1" Background="LightGray">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="0.83*" />
                                            <ColumnDefinition Width="0.83*" />
                                            <ColumnDefinition Width="0.83*" />
                                            <ColumnDefinition Width="0.83*" />
                                            <ColumnDefinition Width="0.83*" />
                                            <ColumnDefinition Width="0.83*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <CheckBox Content="A"     Grid.Row="0" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.A, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="B"     Grid.Row="0" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.B, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="L"     Grid.Row="0" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.L, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="R"     Grid.Row="0" Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.R, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="Z"     Grid.Row="0" Grid.Column="4" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.Z, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="S"     Grid.Row="0" Grid.Column="5" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.Start, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                        <CheckBox Content="C^"    Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.CPadUp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="C&lt;" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.CPadLeft, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="Cv"    Grid.Row="3" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.CPadDown, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="C>"    Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.CPadRight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        
                                        <CheckBox Content="D^"    Grid.Row="1" Grid.Column="4" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.DPadUp, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="D&lt;" Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.DPadLeft, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="Dv"    Grid.Row="3" Grid.Column="4" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.DPadDown, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                        <CheckBox Content="D>"    Grid.Row="2" Grid.Column="5" HorizontalAlignment="Center" VerticalAlignment="Center" IsChecked="{Binding SelectedSample.DPadRight, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                    </Grid>





                                </Grid>
                                <Grid HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="5" ShowGridLines="True">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Button Grid.Column="1" Content="&lt;&lt;"  CommandParameter="-5"  Command="{Binding SampleIndexChange}"/>
                                    <Button Grid.Column="2" Content="&lt;"  CommandParameter="-1"  Command="{Binding SampleIndexChange}"/>
                                    <TextBox Grid.Column="3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Text="{Binding CurrentSampleIndex, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
                                    <Button Grid.Column="4"  Content="&gt;"  CommandParameter="1"  Command="{Binding SampleIndexChange}"/>
                                    <Button Grid.Column="5"  Content="&gt;&gt;"  CommandParameter="5"  Command="{Binding SampleIndexChange}"/>
                                </Grid>
                            </Grid>
                        </TabItem>
                    </TabControl>

                    

                   


                </Grid>

                <Grid ShowGridLines="False" Margin="20">
                    <!-- Header -->
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="3*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Label     Grid.Column="0" Grid.Row="0" Content="{x:Static resx:Resources.Author}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <TextBox   Grid.Column="1" Grid.Row="0" Text="{Binding Header.Author, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Label     Grid.Column="0" Grid.Row="1" Content="{x:Static resx:Resources.Description}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <TextBox   Grid.Column="1" Grid.Row="1" Text="{Binding Header.Description, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Label     Grid.Column="0" Grid.Row="2" Content="{x:Static resx:Resources.RomName}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <TextBox   Grid.Column="1" Grid.Row="2" Text="{Binding Header.RomName, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Button     Grid.Column="0" Grid.Row="3" Content="{x:Static resx:Resources.RomCountry}" Background="Transparent" BorderBrush="Gray" Style="{StaticResource ReactiveButton}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Foreground="Blue" Command="{Binding EditCountry}"/>
                    <TextBox   Grid.Column="1" Grid.Row="3" Text="{Binding Header.RomCountry, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                    <Separator Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="2" Margin="0" HorizontalAlignment="Stretch" Background="Silver"/>

                    <Label     Grid.Column="0" Grid.Row="5" Content="{x:Static resx:Resources.Rerecords}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <TextBox   Grid.Column="1" Grid.Row="5" Text="{Binding Header.Rerecords, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Label     Grid.Column="0" Grid.Row="6" Content="{x:Static resx:Resources.LengthSamples}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <TextBox   Grid.Column="1" Grid.Row="6" Text="{Binding Header.LengthSamples, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Button     Grid.Column="0" Grid.Row="7" Content="{x:Static resx:Resources.Controllers}" Background="Transparent" BorderBrush="Gray" Style="{StaticResource ReactiveButton}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Foreground="Blue" Command="{Binding EditControllerFlags}"/>
                    <TextBox   Grid.Column="1" Grid.Row="7" Text="{Binding Header.Controllers, Mode=TwoWay}" BorderBrush="Transparent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                </Grid>



            </Grid>


            <Grid x:Name="Grid_ControllerFlagsEditing" IsHitTestVisible="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=ControllerFlagsEditing}" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <ScaleTransform/>
                </Grid.RenderTransform>
                
                <Grid.Style>
                    <Style TargetType="{x:Type Grid}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=ControllerFlagsEditing}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>

                <Rectangle Fill="LightGray" RadiusX="5" RadiusY="5"/>

                <Grid Grid.Row="0" ShowGridLines="False" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="3*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>


                    <Label    Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2" Content="{x:Static resx:Resources.Controller0}" FontSize="13" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Separator                Grid.Row="1" Grid.ColumnSpan="2" Background="Silver"/>
                    <Label    Grid.Column="0" Grid.Row="2" Content="{x:Static resx:Resources.Connected}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <CheckBox Grid.Column="1" Grid.Row="2" IsChecked="{Binding Path=Header.ControllerFlags.Controller0Connected, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="3" Content="{x:Static resx:Resources.Mempak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="3" IsChecked="{Binding Path=Header.ControllerFlags.Controller0Mempak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="4" Content="{x:Static resx:Resources.Rumblepak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="4" IsChecked="{Binding Path=Header.ControllerFlags.Controller0Rumblepak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />

                    <Label     Grid.Column="0" Grid.Row="5" Grid.ColumnSpan="2" Content="{x:Static resx:Resources.Controller1}" FontSize="13" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Separator Grid.Row="6" Grid.ColumnSpan="2" Background="Silver"/>
                    <Label    Grid.Column="0" Grid.Row="7" Content="{x:Static resx:Resources.Connected}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="7" IsChecked="{Binding Path=Header.ControllerFlags.Controller1Connected, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <Label    Grid.Column="0" Grid.Row="8" Content="{x:Static resx:Resources.Mempak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="8" IsChecked="{Binding Path=Header.ControllerFlags.Controller1Mempak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="9" Content="{x:Static resx:Resources.Rumblepak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="9" IsChecked="{Binding Path=Header.ControllerFlags.Controller1Rumblepak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                    <Label     Grid.Column="0" Grid.Row="10" Grid.ColumnSpan="2"  Content="{x:Static resx:Resources.Controller2}" FontSize="13" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Separator Grid.Row="11" Grid.ColumnSpan="2" Background="Silver"/>
                    <Label    Grid.Column="0" Grid.Row="12" Content="{x:Static resx:Resources.Connected}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="12" IsChecked="{Binding Path=Header.ControllerFlags.Controller2Connected, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="13" Content="{x:Static resx:Resources.Mempak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="13" IsChecked="{Binding Path=Header.ControllerFlags.Controller2Mempak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="14" Content="{x:Static resx:Resources.Rumblepak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="14" IsChecked="{Binding Path=Header.ControllerFlags.Controller2Rumblepak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />

                    <Label     Grid.Column="0" Grid.Row="15" Grid.ColumnSpan="2" Content="{x:Static resx:Resources.Controller3}" FontSize="13" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Separator Grid.Row="16" Grid.ColumnSpan="2" Background="Silver"/>
                    <Label    Grid.Column="0" Grid.Row="17" Content="{x:Static resx:Resources.Connected}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="17" IsChecked="{Binding Path=Header.ControllerFlags.Controller3Connected, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="18" Content="{x:Static resx:Resources.Mempak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="18" IsChecked="{Binding Path=Header.ControllerFlags.Controller3Mempak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <Label    Grid.Column="0" Grid.Row="19" Content="{x:Static resx:Resources.Rumblepak}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <CheckBox Grid.Column="1" Grid.Row="19" IsChecked="{Binding Path=Header.ControllerFlags.Controller3Rumblepak, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />

                    

                </Grid>

                
                <Border BorderBrush="Gray" BorderThickness="2" CornerRadius="5" />

            </Grid>

            <Grid x:Name="Grid_CountryEditing" IsHitTestVisible="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=CountryEditing}" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <ScaleTransform/>
                </Grid.RenderTransform>

                <Grid.Style>
                    <Style TargetType="{x:Type Grid}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=CountryEditing}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>

                <Rectangle Fill="LightGray" RadiusX="5" RadiusY="5"/>

                <Grid Grid.Row="0" ShowGridLines="False" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="3*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Label    Grid.Column="0"    Grid.Row="0" Content="{x:Static resx:Resources.USA}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="0" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=69, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="69"/>

                    <Label    Grid.Column="0"    Grid.Row="1" Content="{x:Static resx:Resources.USAJapan}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="1" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=65, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="65"/>

                    <Label    Grid.Column="0"    Grid.Row="2" Content="{x:Static resx:Resources.Germany}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="2" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=68, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="68"/>
                    
                    <Label    Grid.Column="0"    Grid.Row="3" Content="{x:Static resx:Resources.France}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="3" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=70, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="70"/>

                    <Label    Grid.Column="0"    Grid.Row="4" Content="{x:Static resx:Resources.Italy}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="4" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=73, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="73" />

                    <Label    Grid.Column="0"    Grid.Row="5" Content="{x:Static resx:Resources.Japan}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="5" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=74, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="74" />

                    <Label    Grid.Column="0"    Grid.Row="6" Content="{x:Static resx:Resources.Spain}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                    <RadioButton Grid.Column="1" Grid.Row="6" IsChecked="{Binding Path=Header.RomCountry, Converter={StaticResource ushortEqConverter}, ConverterParameter=83, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Command="{Binding CountryChanged}" CommandParameter="83" />

                </Grid>

                    
                <Border BorderBrush="Gray" BorderThickness="2" CornerRadius="5" />

            </Grid>

            <Grid x:Name="Grid_InputStatistics" IsHitTestVisible="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=InputStatistics}" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <ScaleTransform/>
                </Grid.RenderTransform>

                <Grid.Style>
                    <Style TargetType="{x:Type Grid}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=InputStatistics}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>

                <Rectangle Fill="LightGray" RadiusX="5" RadiusY="5"/>

               
                    <ListView x:Name="ListView_Statistics" ItemsSource="{Binding Statistics}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="Transparent" BorderThickness="3">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="{x:Static resx:Resources.Name}" DisplayMemberBinding="{Binding Name}" Width="Auto"/>
                                <GridViewColumn Header="{x:Static resx:Resources.Evaluation}" DisplayMemberBinding="{Binding Description}" Width="Auto"/>
                                <GridViewColumn Header="{x:Static resx:Resources.Value}" DisplayMemberBinding="{Binding Value}" Width="Auto"/>
                            </GridView>
                        </ListView.View>
                    </ListView>

                
                <Border BorderBrush="Gray" BorderThickness="2" CornerRadius="5" />

            </Grid>
            
        </Grid>

        <Grid x:Name="Grid_MovieDiagnosis" IsHitTestVisible="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=MovieDiagnosis}" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" RenderTransformOrigin="0.5,0.5">
            <Grid.RenderTransform>
                <ScaleTransform/>
            </Grid.RenderTransform>

            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Mode, Converter={StaticResource eqConverter}, ConverterParameter=MovieDiagnosis}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <Rectangle Fill="LightGray" RadiusX="5" RadiusY="5"/>


            <ListView x:Name="ListView_Diagnosis" ItemsSource="{Binding Diagnosis}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="Transparent" BorderThickness="3">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="{x:Static resx:Resources.Check}" DisplayMemberBinding="{Binding Name}" Width="Auto"/>
                        <GridViewColumn Header="{x:Static resx:Resources.Evaluation}" DisplayMemberBinding="{Binding Description}" Width="Auto"/>
                        <GridViewColumn Header="{x:Static resx:Resources.Status}" DisplayMemberBinding="{Binding Value}" Width="Auto"/>
                    </GridView>
                </ListView.View>
            </ListView>


            <Border BorderBrush="Gray" BorderThickness="2" CornerRadius="5" />

        </Grid>

   

    
    <Grid x:Name="Grid_PreMain" IsHitTestVisible="{Binding FileLoaded, Converter={StaticResource invBool}}">
            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding FileLoaded}" Value="False">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            
        <!--<Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.25*" />
                <ColumnDefinition Width="1.25*" />
                <ColumnDefinition Width="1.25*" />
                <ColumnDefinition Width="1.25*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="1.25*" />
                <RowDefinition Height="1.25*" />
                <RowDefinition Height="1.25*" />
                <RowDefinition Height="1.25*" />
            </Grid.RowDefinitions>
        </Grid>-->

            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Top">
                <!--<StackPanel.Effect>
                    <DropShadowEffect BlurRadius="15" Direction="0" ShadowDepth="0"/>
                </StackPanel.Effect>-->
                <Button HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5" MaxWidth="64" MaxHeight="64"  MinWidth="64" MinHeight="64" Style="{StaticResource ReactiveButton}">
                    <Button.Background>
                        <ImageBrush ImageSource="pack://application:,,,/Resources/logo.png"/>
                    </Button.Background>
                </Button>
            <Label FontSize="30" Content="{x:Static resx:Resources.AppName}" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5"/>
            </StackPanel>
            
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <Button Content="{x:Static resx:Resources.LoadMovie}" Command="{Binding LoadMovie }" Style="{StaticResource ReactiveButton}" FontSize="16"/>
        </StackPanel>

    </Grid>

        <Grid HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False" Opacity="0" RenderTransformOrigin="0.5,0.5" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="5*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="2*" />
                <RowDefinition Height="3*" />
            </Grid.RowDefinitions>

            <Grid.RenderTransform>
                <ScaleTransform/>
            </Grid.RenderTransform>
            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Error.Visible, UpdateSourceTrigger=PropertyChanged}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard Storyboard="{StaticResource BounceAndFade}" />
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard Storyboard="{StaticResource BounceAndFade}" />
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <Rectangle Fill="Gray" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.ColumnSpan="2" Grid.RowSpan="2">
                <Rectangle.Effect>
                    <BlurEffect Radius="10"/>
                </Rectangle.Effect>
            </Rectangle>
            <TextBlock Text="!" FontSize="30" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Row="0" Grid.Column="0" Foreground="White"/>
            <TextBlock Text="{Binding Path=Error.Message, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Center" VerticalAlignment="Center" TextWrapping="Wrap" MaxWidth="256" Grid.Row="1" Foreground="White"/>

            
        </Grid>

        <Grid HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False" Opacity="0" RenderTransformOrigin="0.5,0.5" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="5*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="2*" />
                <RowDefinition Height="3*" />
            </Grid.RowDefinitions>

            <Grid.RenderTransform>
                <ScaleTransform/>
            </Grid.RenderTransform>
            <Grid.Style>
                <Style TargetType="{x:Type Grid}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=Busy, UpdateSourceTrigger=PropertyChanged}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>

            <Rectangle Fill="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.ColumnSpan="2" Grid.RowSpan="2" RadiusX="30" RadiusY="30">
                <Rectangle.Effect>
                    <DropShadowEffect BlurRadius="30" Direction="0" ShadowDepth="0"/>
                </Rectangle.Effect>
            </Rectangle>
            <Image gif:ImageBehavior.AnimatedSource="pack://application:,,,/Resources/loading.gif" gif:ImageBehavior.AnimationSpeedRatio="7" HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="0" Grid.Row="0"/>


        </Grid>
        
        

        <Menu HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Background="Transparent" >
            

            <MenuItem Header="File">
                <!--<MenuItem.Style>
                    <Style TargetType="{x:Type MenuItem}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding FileLoaded}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeIn}" />
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard Storyboard="{StaticResource FadeOut}" />
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </MenuItem.Style>-->
                
                <MenuItem Command="{Binding LoadMovie}" Header="{x:Static resx:Resources.LoadMovie}"/>
                <MenuItem Command="{Binding LoadLastMovie}" Header="{x:Static resx:Resources.LoadLastMovie}"/>

                <MenuItem Command="{Binding SaveMovie}" Header="{x:Static resx:Resources.SaveMovie}" IsEnabled="{Binding FileLoaded}"/>
                <MenuItem Command="{Binding DiagnoseMovie}" Header="{x:Static resx:Resources.MovieDiagnosis}" IsEnabled="{Binding FileLoaded}"/>
                <!--<MenuItem Command="{Binding BypassMovie}" Header="{x:Static resx:Resources.BypassMovie}"/>-->
                <Separator/>
                <MenuItem Command="{Binding UnloadMovie}" Header="{x:Static resx:Resources.UnloadMovie}"/>
            </MenuItem>
        </Menu>

       
    </Grid> <!--parent grid-->
</Window>
